# ENS_Bioelectronics
Analysis of gut electrophysiology using implantable bioelectroni

This repository provides a complete pipeline for analyzing chronic gut electrophysiology recordings and putative neuronal responses to feeding. It includes:

### 1. Data

Due to its large size, the raw data from this study is not hosted here. All datasets are available for download at:

- [Zenodo Dataset 1](https://doi.org/10.5281/zenodo.15162113): https://doi.org/10.5281/zenodo.15162113
- [Zenodo Dataset 2](https://doi.org/10.5281/zenodo.15162121): https://doi.org/10.5281/zenodo.15162121.

### 2. Demo Code: Python and MATLAB

- **Python Jupyter Notebooks**
    - Designed for processing datasets recorded under anaesthesia and performing stress-response, multi-frequency band analyses. On a machine with 32 GB RAM, the demo completes in under one minute.
    - **Installation:** Requires Python â‰¥ 3.10. In a virtual environment, install dependencies using: pip install -r python_requirements.txt Typical install time is approximately 1 minute on a standard computer.
    - **Usage:** Each notebook includes detailed instructions at the top. The primary notebook, `analysis_gut_ephys.ipynb`, is pre-configured to run the demo on the dataset `rat1_distension_230714_111548_112648_Port A.pkl` (from the first repository link above), facilitating reproduction of the expected results. Instructions for adapting the code to other datasets are also provided. The secondary notebook, `gut_chronic_plots.ipynb`, visualizes outputs generated by `analysis_gut_ephys.ipynb`.
- **MATLAB Scripts**
    - For spike sorting, putative neuron classification, and analysis of neuronal responses to feeding events.
    - **Installation and usage:** Information is included in the 'Matlab scripts' folder. The associated .mat files, including both the initial information and intermediate outputs generated by each script, are provided in the corresponding subfolders.

### 3. Data Format Note

The Intan stimulation and recording system saves `.rhs` files as 1-minute segments containing both header information and signal data. These raw files were processed using official Intan code, which extracts continuous signals, timestamps, and metadata from each segment. The data were then organized into structured pandas DataFrames and saved in serialized formats (`.pkl` or `.parquet`) to enable efficient loading and downstream analysis.

### 4. Expected Outputs

This repository includes example output plots generated by the python and Matlab demos to help verify successful execution.

